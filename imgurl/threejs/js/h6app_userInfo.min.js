!function(){var _h6app_config=window._h6app_config||{},h6app_config={prefix:_h6app_config.prefix||"h6",sso_url:_h6app_config.sso_url||"http://sso.h6app.com/oauth",appid:_h6app_config.appid||"wx95f30de6c5026cd8",scope:_h6app_config.scope||"snsapi_base",getUnionid:_h6app_config.getUnionid||!1,version:_h6app_config.version||"1_0_8",shareInfoKey:_h6app_config.shareInfoKey||"shareInfo",sso_clean:_h6app_config.sso_clean||!0,share_clean:_h6app_config.share_clean||!1,pc_view:_h6app_config.pc_view||!0},prefix=h6app_config.prefix,userInfo={},shareInfo={},query={get:function(a,b){var c=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i"),d=location.search.substr(1).match(c);return b&&(d=(b.split("#")[0].split("?")[1]||"").match(c)),d?decodeURIComponent(d[2]):null},set:function(a,b,c){return this.change(c||location.href,a,b)},del:function(a,b){return this.delete(a,b)},change:function(url,name,val){var tmp,pattern=name+"=([^&]*)",replaceText=name+"="+val,hash=2===url.split("#").length?"#"+url.split("#")[1]:"";return url=url.split("#")[0],url.match(pattern)?(tmp="/("+name+"=)([^&]*)/gi",tmp=url.replace(eval(tmp),replaceText),tmp+hash):url.match("[?]")?url+"&"+replaceText+hash:url+"?"+replaceText+hash},"delete":function(a,b){var h,i,c={},d=b||location.href,e=d.split("#")[0].split("?"),f=e[0],g=2===d.split("#").length?"#"+d.split("#")[1]:"";if(e[1]&&0<e[1].length){e=e[1].split("&");for(h in e)i=e[h].split("="),c[i[0]]=i[1]}a&&delete c[a];for(h in c)e="&",f.match("[?]")||(e="?"),f+=e+h+"="+c[h];return f+g}},h6app_userInfo={localStorageKeyName:"h6app_userInfo_"+h6app_config.version,get:function(){var b,c,d,a=h6app_userInfo.localStorageKeyName;query.get(prefix+"openid")&&query.get(prefix+"s")&&query.get(prefix+"t")?!query.get(prefix+"unionid")&&h6app_config.getUnionid?(h6app_config.scope="snsapi_userinfo",h6app_userInfo.reinit()):(userInfo={openid:query.get(prefix+"openid"),s:query.get(prefix+"s"),unionid:query.get(prefix+"unionid"),sign_time:query.get(prefix+"t"),sign:query.get(prefix+"sign"),nickname:query.get(prefix+"nickname"),headimgurl:query.get(prefix+"headimgurl")},localStorage.setItem(a,JSON.stringify(userInfo)),(h6app_config.sso_clean||h6app_config.share_clean&&query.get(h6app_config.shareInfoKey))&&(h6app_config.sso_clean&&(b=location.href.toString(),b=query.del(prefix+"openid",b),b=query.del(prefix+"s",b),b=query.del(prefix+"unionid",b),b=query.del(prefix+"t",b),b=query.del(prefix+"sign",b),b=query.del(prefix+"token",b),b=query.del(prefix+"state",b),b=query.del(prefix+"nickname",b),b=query.del(prefix+"headimgurl",b),b=query.del(prefix+"sex",b),b=query.del(prefix+"country",b),b=query.del(prefix+"province",b),b=query.del(prefix+"city",b)),h6app_config.share_clean&&query.get(h6app_config.shareInfoKey),b&&(b=query.del(query.del(h6app_config.shareInfoKey),b)),location.replace(b))):query.get(prefix+"openid",document.referrer)&&query.get(prefix+"s",document.referrer)&&query.get(prefix+"t",document.referrer)?!query.get(prefix+"unionid",document.referrer)&&h6app_config.getUnionid?(h6app_config.scope="snsapi_userinfo",h6app_userInfo.reinit()):(userInfo={openid:query.get(prefix+"openid",document.referrer),s:query.get(prefix+"s",document.referrer),unionid:query.get(prefix+"unionid",document.referrer),sign_time:query.get(prefix+"t",document.referrer),sign:query.get(prefix+"sign",document.referrer),nickname:query.get(prefix+"nickname",document.referrer),headimgurl:query.get(prefix+"headimgurl",document.referrer)},localStorage.setItem(a,JSON.stringify(userInfo)),h6app_config.share_clean&&query.get(h6app_config.shareInfoKey)&&location.replace(query.del(h6app_config.shareInfoKey))):localStorage.getItem(a)&&localStorage.getItem(a).length>90?(userInfo=JSON.parse(localStorage.getItem(a)),c=1e3*userInfo.sign_time,d=(new Date).getTime(),d-c>828e5?(localStorage.removeItem(a),userInfo={},h6app_userInfo.reinit()):h6app_config.share_clean&&query.get(h6app_config.shareInfoKey)&&location.replace(query.del(h6app_config.shareInfoKey))):h6app_userInfo.reinit()},reinit:function(){var b,a=navigator.userAgent.toLowerCase();(a.match(/MicroMessenger/i)||!h6app_config.pc_view)&&(b=h6app_config.sso_url+"?redirect_uri="+encodeURIComponent(query.del(h6app_config.shareInfoKey))+"&scope="+h6app_config.scope+"&state=&appid="+h6app_config.appid+"&prefix="+prefix,window.location.replace(b))}},h6app_shareInfo={get:function(){var a=query.get(h6app_config.shareInfoKey);if(a?sessionStorage.setItem(h6app_config.shareInfoKey,a):sessionStorage.getItem(h6app_config.shareInfoKey)&&(a=sessionStorage.getItem(h6app_config.shareInfoKey)),a&&a.length)try{shareInfo=JSON.parse(a)}catch(b){shareInfo=null}else shareInfo=null;h6app_userInfo.get()}};h6app_shareInfo.get(),window.h6app_query=query,window.h6app_userInfo=userInfo,window.h6app_shareInfo=shareInfo}();