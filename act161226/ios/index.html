<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>
<meta name="format-detection" content="telephone=no,email=no">
<title>六周年·回忆篇</title>
<script>
    document.documentElement.style.fontSize = document.documentElement.clientWidth / 7.5 + 'px';
    (function (doc, win) {
	    var docEl = doc.documentElement,resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize';
	    function recalc() {
	        var clientWidth = docEl.clientWidth;
	        if (!clientWidth) return;
	        clientWidth=clientWidth > 750 ? 750 : clientWidth;
	        docEl.style.fontSize = (clientWidth / 7.5) + 'px';
	    };
	    if(!doc.addEventListener) return;
	    win.addEventListener(resizeEvt, recalc, false);
	    doc.addEventListener('DOMContentLoaded', recalc, false);
	})(document, window);
</script>
<link href="css/index.css" rel="stylesheet">
</head>
<body>
<div class="loadpage show" id="loadpage">
	<img src="images/logo.png" class="logo">
	<div class="qq">
		<img src="images/qq.png">
	</div>
	<p class="pro" id="pro">0%...</p>
</div>
<div class="wrap" id="wrap">
	<div class="s1">
		<img src="images/s1-tree.png" class="tree s1-tree">
		<div class="time">
			<i class="t2"></i><i class="t0"></i><i class="t1"></i><i class="t0" id="t"></i>
		</div>
		<div class="txt">
			<div class="typing">
				<img src="images/s1-1.png">
			</div>
			<img src="images/s1-2.png">
			<img src="images/s1-3.png">
		</div>
		<div class="egg auto-x"></div>
		<div class="shadow">
			<i></i>
			<i></i>
		</div>
	</div>
	<div class="s2">
		<div class="elem1">
			<img src="images/s2-8.png" class="sj">
			<ul class="blist auto-x">
				<img src="images/s2-7.png">
				<img src="images/s2-6.png">
				<img src="images/s2-5.png">
				<img src="images/s2-4.png">
			</ul>
			<div class="logo">
				<img src="images/s2-9.png">
				<img src="images/s2-10.png" class="line">
			</div>
		</div>	
		<img src="images/s2-tree.png" class="tree s2-tree auto-x">
		<div class="time">
			<i class="t2"></i><i class="t0"></i><i class="t1"></i><i class="t1"></i>
		</div>
		<div class="txt">
			<div class="typing">
				<img src="images/s2-1.png">
			</div>
			<img src="images/s2-2.png">
			<img src="images/s2-3.png">
		</div>
	</div>
	<div class="s3">
		<div class="elem1">
			<img src="images/s3-4.png" class="logo">
			<img src="images/s3-5.png" class="cup">
			<img src="images/s3-7.png" class="person">
		</div>
		<div class="time">
			<i class="t2"></i><i class="t0"></i><i class="t1"></i><i class="t2"></i>
		</div>
		<div class="txt">
			<div class="typing">
				<img src="images/s3-1.png">
			</div>
			<img src="images/s3-2.png">
			<img src="images/s3-3.png">
		</div>
	</div>
	<div class="s4">
		<img src="images/s4-tree.png" class="tree s4-tree">
		<div class="elem1">
			<img src="images/s4-9.png" class="logo">
			<div class="ip">
				<img src="images/s4-8.png">
				<img src="images/s4-6.png">
				<img src="images/s4-7.png">
				<img src="images/s4-5.png">
				<img src="images/s4-4.png">
			</div>
		</div>
		<div class="time">
			<i class="t2"></i><i class="t0"></i><i class="t1"></i><i class="t3"></i>
		</div>
		<div class="txt">
			<div class="typing">
				<img src="images/s4-1.png">
			</div>
			<img src="images/s4-2.png">
			<img src="images/s4-3.png">
		</div>
	</div>
	<div class="s5">
		<div class="time">
			<i class="t2"></i><i class="t0"></i><i class="t1"></i><i class="t4"></i>
		</div>
		<div class="txt">
			<div class="typing">
				<img src="images/s5-1.png">
			</div>
			<img src="images/s5-2.png">
			<img src="images/s5-3.png">
		</div>
		<img src="images/s5-4.png" class="ztj">
		<img src="images/s5-5.png" class="logo auto-x">
	</div>
	<div class="s6">
		<div class="time">
			<i class="t2"></i><i class="t0"></i><i class="t1"></i><i class="t5"></i>
		</div>
		<div class="txt">
			<div class="typing">
				<img src="images/s6-1.png">
			</div>
			<img src="images/s6-2.png">
			<img src="images/s6-3.png">
			<img src="images/s6-4.png">
		</div>
		<div class="elem1 auto-x">
			<img src="images/s6-6.png" class="logo">
			<img src="images/s6-7.png" class="hg">
		</div>
	</div>
	<div class="s7">
		<div class="time">
			<i class="t2"></i><i class="t0"></i><i class="t1"></i><i class="t6"></i>
		</div>
		<div class="txt">
			<div class="typing">
				<img src="images/s7-1.png" class="p1">
			</div>
			<div class="total">
				<i class="a5"></i><i class="a6"></i><i class="a9"></i>
				<i class="a5"></i><i class="a4"></i><i class="a2"></i>
				<i class="a1"></i><i class="a4"></i><i class="a1"></i><i class="a0"></i>
			</div>
			<img src="images/s7-2.png">
		</div>
		<div class="share" id="share">
			<img src="images/s7-3.png">
		</div>
		<div class="elem1">
			<div class="person">
				<div class="rw"></div>
				<img src="images/s7-5.png">
			</div>
			<div class="logo">
				<img src="images/s7-4.png" class="logoqq">
				<img src="images/s7-8.png" class="logosd">
			</div>	
		</div>
		<div class="side auto-x">
			<img src="images/s7-6.png">
			<img src="images/s7-7.png">
		</div>
	</div>
</div>
<div class="music" id="music"></div>
<span class="uparrow" id="uparrow"></span>
<audio src="music.mp3" preload loop id="audio1"></audio>
<script src="js/zepto.min.js"></script>
<script src="js/jsbridge.js"></script>
<script src="js/cfoot.js"></script>
<script src="js/charm.js"></script>
<script src="js/local.js"></script>
<script>
	//加载进度
    var resources=["s1-bg.jpg","egg.png","timer.png","s1-1.png","s1-2.png","s1-3.png","s1-tree.png","s2-bg.jpg","s2-1.png","s2-2.png","s2-3.png","s2-4.png","s2-5.png","s2-6.png","s2-7.png","s2-8.png","s2-9.png","s2-10.png","s2-tree.png","s3-bg.jpg","s3-1.png","s3-2.png","s3-3.png","s3-4.png","s3-5.png","s3-6.png","s3-7.png","s4-bg.jpg","s4-1.png","s4-2.png","s4-3.png","s4-4.png","s4-5.png","s4-6.png","s4-7.png","s4-8.png","s4-9.png","s4-tree.png","s5-bg.jpg","s5-1.png","s5-2.png","s5-3.png","s5-4.png","s5-5.png","s6-bg.jpg","s6-1.png","s6-2.png","s6-3.png","s6-4.png","s6-6.png","s6-7.png","s7-bg.jpg","s7-1.png","s7-2.png","s7-3.png","s7-4.png","s7-5.png","s7-6.png","s7-7.png"];
    function loading(){
    	var length = resources.length;//图片数量
    	var percent = 0;
    	var downImg = 0;
    	for(var i=0;i<length;i++){
			var img = new Image();
			img.src = "images/"+resources[i];
			if(img.complete){//有缓存
				imgDown();
			}else{
				img.onload=function(){//无缓存
					imgDown();
				}
			}
		}
		function imgDown(){
			downImg ++;
			percent = parseInt(100*downImg/length);
			$("#pro").text(percent+"%");
			if ( percent == 100 ){
				setTimeout(function(){
					loadend();
				},2000)		
			}
    	}
    }
    loading();
    //显示主页
    function loadend(){
    	$("#wrap").addClass("show");
    	$("#wrap .s1").addClass("active");
    	$("#loadpage").removeClass("show"); 
    	setTimeout(function(){
			$("#uparrow").show();
    	},5000) 	
    	forceLog(param("act_f"),"page0");
    }	
    //滚屏
    $(document).on("touchmove",function(e){
    	e.preventDefault();
    })
	var iNow=0,winH=$(window).height(),len=$("#wrap>div").length-1,ismove=true;
	$('#wrap').on('touchstart',function(ev){
		if(ismove){
			touchStartY=ev.targetTouches[0].pageY;   
	        $('#wrap').on('touchmove',function(ev){
	            ev.preventDefault();
	        })
	        $('#wrap').on('touchend',function(ev){  
	            var offsetY=ev.changedTouches[0].pageY - touchStartY;
	            if(offsetY > 30){
	                iNow-=1;
	                if(iNow<0){iNow=0;}             
	                if(iNow==len-1){
	                    $('#uparrow').show();
	                }
	                swiper(iNow);               
	            }else if(offsetY <- 30){
	                iNow+=1;
	                if(iNow>=len){
	                    iNow=len;
	                    $('#uparrow').hide();
	                }
	                swiper(iNow); 
	            }
	            $('#wrap').off('touchmove touchend');
	        })
		}
    }) 
    function swiper(iNow){
    	ismove=false;
        $('#wrap>div').eq(iNow).addClass('active').siblings().removeClass("active");
        setTimeout(function(){
        	ismove=true;
        },1000)
        $('#wrap').css('-webkit-transform','translate3d(0,'+-winH*iNow+'px,0)');
        forceLog(param("act_f"),"page"+iNow);
    }
    //music  
    var voice=$("#audio1")[0];  
    function forceSafariPlayAudio() {
        voice.load(); 
        voice.play(); 
        voice.open=true;
        $("#music").addClass("rotating");
    }
	voice.addEventListener('play', function() {
        window.removeEventListener('touchstart', forceSafariPlayAudio, false);
    }, false);
    window.addEventListener('touchstart', forceSafariPlayAudio, false);
    $("#music").on("touchend",function(){
    	music();
    })
    function music(){
		if(voice.open){
			voice.open=false;
			voice.pause();		
			$("#music").removeClass("rotating");
		}else{
			voice.open=true;
			voice.play();
			$("#music").addClass("rotating");
		}
	}
	//share
	var shareObj = {
		url : prefix()+ "act161226/com/index.html",
		cover : "https://yuedu.reader.qq.com/event/act161226/com/images/cover.jpg",
		"title" : "六年了，我们的回忆都在这",
		"desc" : "QQ阅读周年庆，快来分享我们一起走过的路"
	};
	$("#share").on("click",function(){
		//ismove=true;
		Local.shareEventListen(shareObj.title, shareObj.desc, shareObj.cover,shareObj.url);
		Local.shareControl();
		forceLog(param("act_f"),"FXbtn");
	})
	forceLog(param("act_f"),"pageInit");
</script>
</body>
</html>